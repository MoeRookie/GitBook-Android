## 登录案例

* #### 画UI

![](/assets/登录案例 - 界面.png)

```java
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">
    <EditText
        android:id="@+id/et_uname"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="请输入用户名" />
    <EditText
        android:id="@+id/et_pwd"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:password="true"
        android:hint="请输入密码" />
    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginTop="20dp">
        <CheckBox
            android:id="@+id/cb_is_check"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="记住用户名密码" />
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:onClick="login"
            android:text="登录" />
    </RelativeLayout>
</LinearLayout>
```

* #### 根据UI写对应的业务逻辑
* ##### 1、主界面

```java
package com.liqun.login;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.text.TextUtils;
import android.util.Log;
import android.view.View;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.Toast;
import com.liqun.login.utils.UserInfoUtils;
import java.util.Map;
public class MainActivity extends AppCompatActivity {
    private static final String TAG = MainActivity.class.getSimpleName();
    private EditText mEtUName;
    private EditText mEtPwd;
    private CheckBox mCbIsCheck;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        // [1]找到我们关心的控件
        mEtUName = findViewById(R.id.et_uname);
        mEtPwd = findViewById(R.id.et_pwd);
        mCbIsCheck = findViewById(R.id.cb_is_check);
        // [1.1]读取data/data下info.txt的信息
        Map<String, String> maps = UserInfoUtils.readUserInfo();
        if (maps != null) {
            // 把uname和pwd取出来
            String uname = maps.get("uname");
            String pwd = maps.get("pwd");
            // [1.2]把uname和pwd显示到editText控件上
            mEtUName.setText(uname);
            mEtPwd.setText(pwd);
        }
    }
    // [2]添加按钮的点击事件
    public void login(View view) {
        // [2.1]获取用户名和密码
        String uname = mEtUName.getText().toString().trim();
        String pwd = mEtPwd.getText().toString().trim();
        // [2.2]判断uname和pwd是否为空
        if (TextUtils.isEmpty(uname) || TextUtils.isEmpty(pwd)) {
            Toast.makeText(this, "用户名或密码不能为空", Toast.LENGTH_SHORT).show();
            return;
        }
        // [2.3]进行登录的逻辑
        Log.i(TAG, "连接服务器进行登录,等我们讲到第四天网络编程再说...");
        // [2.4]把用户名和密码存起来
        if (mCbIsCheck.isChecked()) {
            boolean isSuccess = UserInfoUtils.saveUserInfo(uname, pwd);
            if (isSuccess) {
                Toast.makeText(this, "保存成功", Toast.LENGTH_SHORT).show();
                return;
            }
            Toast.makeText(this, "保存失败", Toast.LENGTH_SHORT).show();
            return;
        }
        Toast.makeText(this, "请勾选单选框", Toast.LENGTH_SHORT).show();
    }
}
```

* ##### 2、保存用户信息的工具类

```java
package com.liqun.login.utils;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.Map;
public class UserInfoUtils {
    /**
     * 保存用户信息到"data/data/当前应用对应的包名"目录下
     * @param uname 用户名
     * @param pwd 密码
     * @return 是否保存成功
     */
    public static boolean saveUserInfo(String uname,String pwd){
        String result = uname + "##" + pwd;
        // [1]创建File类指定我们要将数据存储到的位置
        File file = new File("data/data/com.liqun.login/info.txt");
        try {
            // [2]创建一个文件输出流
            FileOutputStream fos = new FileOutputStream(file);
            fos.write(result.getBytes());
            fos.close();
            return true;
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
    }
    /**
     * 读取用户信息
     * @return 用户信息map
     */
    public static Map<String, String> readUserInfo() {
        // [1]定义map
        HashMap<String, String> map = new HashMap<>();
        File file = new File("data/data/com.liqun.login/info.txt");
        try {
            FileInputStream fis = new FileInputStream(file);
            BufferedReader br = new BufferedReader(new InputStreamReader(fis));
            // 读取数据
            String content = br.readLine();
            // 切割字符串,封装到map中
            String[] splits = content.split("##");
            map.put("uname",splits[0]);
            map.put("pwd",splits[1]);
            return map;
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
}
```

## 使用上下文获取常见目录

* #### Context

* ##### \[1\]、官方定义

```java
有关应用程序环境的全局信息的接口。
这是一个抽象类，其实现由Android系统提供。
它允许访问特定于应用程序的资源和类，以及对应用程序级操作的上调，例如启动活动，广播和接收意图等。
```

* ##### \[2\]、首次修改

```java
public class UserInfoUtils {
    /**
     * 保存用户信息到"data/data/当前应用对应的包名"目录下
     * @param uname 用户名
     * @param pwd 密码
     * @return 是否保存成功
     */
    public static boolean saveUserInfo(Context context,String uname, String pwd){
        ...
        // [1]创建File类指定我们要将数据存储到的位置
        File file = new File(context.getFilesDir().getPath(),"info.txt");
        ...
    }
    /**
     * 读取用户信息
     * @return 用户信息map
     */
    public static Map<String, String> readUserInfo(Context context) {
        // [1]定义map
        HashMap<String, String> map = new HashMap<>();
        File file = new File(context.getFilesDir().getPath(),"info.txt");
        ...
    }
}
- 提一嘴:
Context对象就类似于一个盛放工具的仓库,仓库里的工具具体能做什么由官方定义;
所以,诸如以上获取存储路径等操作都应首先考虑使用Context对象,如无解决方案再考虑其他方式;
写入以上路径后,在当前应用的包名目录下产生了新的files目录,存储用户信息的文件就存在于此目录中;
```

* ##### \[2\]、末次修改

```java
public class UserInfoUtils {
    /**
     * 保存用户信息到"data/data/当前应用对应的包名"目录下
     * @param uname 用户名
     * @param pwd 密码
     * @return 是否保存成功
     */
    public static boolean saveUserInfo(Context context,String uname, String pwd){
        ...
        // [1]创建File类指定我们要将数据存储到的位置
        try {
            // [2]创建一个文件输出流
            FileOutputStream fos = context.openFileOutput("info.txt",Context.MODE_PRIVATE);
            ...
    }

    /**
     * 读取用户信息
     * @return 用户信息map
     */
    public static Map<String, String> readUserInfo(Context context) {
        // [1]定义map
        HashMap<String, String> map = new HashMap<>();
        try {
            FileInputStream fis = context.openFileInput("info.txt");
            ...
    }
}

```

## 登录数据保存到SD卡

## 获取SD卡可用空间

## 文件权限的介绍

## SharedPreferences介绍



